<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Home Page</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet">
  </head>
  <body>
    <a href="{% url 'home' %}" target="_self" class="btn btn-primary">HOME</a>
    <form action="/share/" method="POST" >
      {% csrf_token %}
      <label for="">choose a User you want to share file with:</label><br>{{form.shared_with}}<br>
      <label for="">choose a file you want share: </label><br>{{form.shared_file}}<br>
      <!-- {{form.shared_with}} -->
      <button type="submit" class ="btn btn-primary">Share</button>
      <!-- <input type="file" name="pdf">  -->
    </form>
    
    <a href="{% url 'logout' %}" class="btn btn-primary">Logout</a>
    <script>
      // JavaScript code
  window.addEventListener("unload", function() {
    // Perform an AJAX request to log out the user
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "/logout/");  // Replace "/logout/" with your logout URL
  
    // Include the CSRF token as a header
    xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
    xhr.setRequestHeader("X-CSRFToken", getCookie("csrftoken"));  // Include the CSRF token as a header
  
    xhr.onload = function() {
      // Handle the response if needed
    };
  
    xhr.send();
  });
  
  // Function to retrieve the CSRF token from the cookie
  function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== "") {
      var cookies = document.cookie.split(";");
  
      for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === name + "=") {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }
  </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
      <script>
        $(document).ready(function() {
            $('#id_shared_file').select2();
        });
    </script>
        <script>
          $(document).ready(function() {
              $('#id_shared_with').select2();
          });
      </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

  </body>
</html>